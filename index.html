<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PatiLink - NFC Hayvan Takip Sistemi</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .pet-card {
            transition: all 0.3s ease;
            transform: translateY(0);
        }
        .pet-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .stats-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        .location-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        .call-button {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }
        .call-button:hover {
            background: linear-gradient(135deg, #38f9d7 0%, #43e97b 100%);
        }
        .emergency-button {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .modal {
            backdrop-filter: blur(10px);
        }
        .form-input {
            transition: all 0.3s ease;
        }
        .form-input:focus {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .qr-code {
            background: linear-gradient(45deg, #667eea, #764ba2);
            padding: 20px;
            border-radius: 15px;
        }
        .feature-card {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }
        .premium-badge {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        }
        .notification {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
        }
        .gallery-item {
            aspect-ratio: 1;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .gallery-item:hover {
            transform: scale(1.05);
        }
        .tab-button {
            transition: all 0.3s ease;
        }
        .tab-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .admin-card {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
        }
        .admin-stats {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }
        .danger-zone {
            background: linear-gradient(135deg, #ff6b6b 0%, #ffa8a8 100%);
        }
    </style>
</head>
<body class="min-h-full bg-gray-50">
    <nav class="gradient-bg shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <h1 class="text-2xl font-bold text-white">ğŸ¾ PatiLink</h1>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="loginBtn" class="text-white hover:text-gray-200 px-3 py-2 rounded-md text-sm font-medium" onclick="handleLoginClick()">GiriÅŸ Yap</button>
                    <button id="registerBtn" class="bg-white text-purple-600 hover:bg-gray-100 px-4 py-2 rounded-md text-sm font-medium" onclick="showModal('registerModal')">Ãœye Ol</button>
                </div>
            </div>
        </div>
    </nav>

    <div id="mainContent" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div id="welcomeSection" class="mb-12">
            <div class="text-center mb-16">
                <h2 class="text-5xl font-bold text-gray-900 mb-6">HayvanÄ±nÄ±zÄ± NFC ile Koruyun</h2>
                <p class="text-xl text-gray-600 mb-8 max-w-3xl mx-auto">Tamamen Ã¼cretsiz! KaybolduÄŸunda hemen bulunabilsin. TasmasÄ±na NFC tag takÄ±n, detaylÄ± profilini oluÅŸturun ve anlÄ±k takip edin.</p>
            </div>

            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-16">
                <div class="feature-card p-6 rounded-xl shadow-lg text-center">
                    <div class="text-5xl mb-4">ğŸ“±</div>
                    <h3 class="text-xl font-semibold mb-3">NFC Teknolojisi</h3>
                    <p class="text-gray-700">Telefon yaklaÅŸtÄ±rÄ±ldÄ±ÄŸÄ±nda otomatik profil aÃ§Ä±lÄ±r</p>
                </div>
                <div class="feature-card p-6 rounded-xl shadow-lg text-center">
                    <div class="text-5xl mb-4">ğŸ“Š</div>
                    <h3 class="text-xl font-semibold mb-3">AnlÄ±k Ä°statistikler</h3>
                    <p class="text-gray-700">KaÃ§ kiÅŸinin taradÄ±ÄŸÄ±nÄ± ve aradÄ±ÄŸÄ±nÄ± gÃ¶rÃ¼n</p>
                </div>
                <div class="feature-card p-6 rounded-xl shadow-lg text-center">
                    <div class="text-5xl mb-4">ğŸ“</div>
                    <h3 class="text-xl font-semibold mb-3">Konum Takibi</h3>
                    <p class="text-gray-700">HayvanÄ±nÄ±zÄ± bulan kiÅŸilerin konumunu gÃ¶rÃ¼n</p>
                </div>
                <div class="feature-card p-6 rounded-xl shadow-lg text-center">
                    <div class="text-5xl mb-4">ğŸš¨</div>
                    <h3 class="text-xl font-semibold mb-3">Acil Durum</h3>
                    <p class="text-gray-700">Tek tÄ±kla arama ve yÃ¶nlendirme</p>
                </div>
            </div>

            <div class="bg-white rounded-2xl shadow-xl p-8 mb-16">
                <h3 class="text-3xl font-bold text-center mb-12">NasÄ±l Ã‡alÄ±ÅŸÄ±r?</h3>
                <div class="grid md:grid-cols-5 gap-8">
                    <div class="text-center">
                        <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-2xl font-bold text-purple-600">1</span>
                        </div>
                        <h4 class="font-semibold mb-2">Ãœye Olun</h4>
                        <p class="text-sm text-gray-600">Hesap oluÅŸturun</p>
                    </div>
                    <div class="text-center">
                        <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-2xl font-bold text-purple-600">2</span>
                        </div>
                        <h4 class="font-semibold mb-2">Profil OluÅŸturun</h4>
                        <p class="text-sm text-gray-600">Hayvan bilgilerini girin</p>
                    </div>
                    <div class="text-center">
                        <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-2xl font-bold text-purple-600">3</span>
                        </div>
                        <h4 class="font-semibold mb-2">NFC Tag Ä°Ã§in Ä°letiÅŸim</h4>
                        <p class="text-sm text-gray-600">Biz NFC'yi programlayÄ±p gÃ¶nderiyoruz</p>
                    </div>
                    <div class="text-center">
                        <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-2xl font-bold text-purple-600">4</span>
                        </div>
                        <h4 class="font-semibold mb-2">TasmasÄ±na TakÄ±n</h4>
                        <p class="text-sm text-gray-600">NFC tag'i hayvanÄ±n tasmasÄ±na takÄ±n</p>
                    </div>
                    <div class="text-center">
                        <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-2xl font-bold text-purple-600">5</span>
                        </div>
                        <h4 class="font-semibold mb-2">GÃ¼vende Olun</h4>
                        <p class="text-sm text-gray-600">AnlÄ±k takip edin</p>
                    </div>
                </div>
            </div>

            <div class="text-center mb-16">
                <h3 class="text-3xl font-bold mb-8">Ãœyelik PlanlarÄ±</h3>
                <div class="grid md:grid-cols-3 gap-8">
                    <div class="bg-white rounded-xl shadow-lg p-8 border-2 border-green-500 relative">
                        <div class="premium-badge absolute -top-3 left-1/2 transform -translate-x-1/2 px-4 py-1 rounded-full text-sm font-semibold">
                            Tamamen Ãœcretsiz
                        </div>
                        <h4 class="text-xl font-semibold mb-4">Temel</h4>
                        <div class="text-3xl font-bold mb-4">â‚º0</div>
                        <ul class="text-left space-y-2 mb-6">
                            <li>âœ… SÄ±nÄ±rsÄ±z Hayvan Profili</li>
                            <li>âœ… TÃ¼m Ã–zellikler</li>
                            <li>âœ… NFC & QR Kod DesteÄŸi</li>
                            <li>âœ… DetaylÄ± Ä°statistikler</li>
                            <li>âœ… Konum Takibi</li>
                            <li>âœ… FotoÄŸraf Galerisi</li>
                            <li>âœ… Sosyal Medya Linkleri</li>
                        </ul>
                        <button onclick="showModal('registerModal')" class="w-full bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg">Ãœcretsiz BaÅŸla</button>
                    </div>
                    <div class="bg-white rounded-xl shadow-lg p-8">
                        <h4 class="text-xl font-semibold mb-4">NFC Tag SatÄ±ÅŸÄ±</h4>
                        <div class="text-3xl font-bold mb-4" id="nfcPriceDisplay">â‚º25</div>
                        <ul class="text-left space-y-2 mb-6">
                            <li>ğŸ·ï¸ HazÄ±r programlanmÄ±ÅŸ NFC tag</li>
                            <li>ğŸ“¦ Ãœcretsiz kargo</li>
                            <li>ğŸ¨ Ã–zel tasarÄ±m seÃ§enekleri</li>
                            <li>ğŸ’§ Su geÃ§irmez</li>
                            <li>ğŸ”§ Kurulum desteÄŸi</li>
                            <li>ğŸ“ Teknik destek</li>
                        </ul>
                        <button onclick="window.open('tel:05386694530', '_blank')" class="w-full bg-orange-500 hover:bg-orange-600 text-white py-2 rounded-lg">ğŸ“ SipariÅŸ Ver</button>
                    </div>
                    <div class="bg-white rounded-xl shadow-lg p-8">
                        <h4 class="text-xl font-semibold mb-4">Pet Shop OrtaklÄ±ÄŸÄ±</h4>
                        <div class="text-3xl font-bold mb-4">Ä°letiÅŸim</div>
                        <ul class="text-left space-y-2 mb-6">
                            <li>ğŸª Pet shop entegrasyonu</li>
                            <li>ğŸ’° Komisyon sistemi</li>
                            <li>ğŸ“Š SatÄ±ÅŸ raporlarÄ±</li>
                            <li>ğŸ¯ Pazarlama desteÄŸi</li>
                            <li>ğŸ“ Ã–zel mÃ¼ÅŸteri hattÄ±</li>
                            <li>ğŸš€ BÃ¼yÃ¼me fÄ±rsatlarÄ±</li>
                        </ul>
                        <button onclick="window.open('tel:05386694530', '_blank')" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg">ğŸ“ OrtaklÄ±k Ä°Ã§in Ara</button>
                    </div>
                </div>
            </div>

            <div class="text-center">
                <a href="?admin=true" class="text-xs text-gray-400 hover:text-gray-600">â€¢</a>
            </div>
        </div>
    </div>

    <div id="userDashboard" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 hidden">
        <div class="flex justify-between items-center mb-8">
            <h2 class="text-3xl font-bold text-gray-900">HayvanlarÄ±m</h2>
            <button id="addPetBtn" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-medium" onclick="showModal('addPetModal')">
                + Yeni Hayvan Ekle
            </button>
        </div>
        
        <div id="petsList" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
            </div>
    </div>

    <div id="adminDashboard" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 hidden">
        <div class="flex justify-between items-center mb-8">
            <h2 class="text-3xl font-bold text-gray-900">ğŸ‘‘ Admin Paneli</h2>
            <button onclick="showWelcomeSection()" class="bg-gray-600 hover:bg-gray-700 text-white px-6 py-3 rounded-lg font-medium">
                â† Ana Sayfa
            </button>
        </div>

        <div class="grid md:grid-cols-5 gap-6 mb-8">
            <div class="admin-stats p-6 rounded-xl shadow-lg text-center">
                <div class="text-4xl font-bold text-purple-600" id="totalUsers">0</div>
                <div class="text-gray-700 font-medium">Toplam KullanÄ±cÄ±</div>
            </div>
            <div class="admin-stats p-6 rounded-xl shadow-lg text-center">
                <div class="text-4xl font-bold text-blue-600" id="totalPets">0</div>
                <div class="text-gray-700 font-medium">Toplam Hayvan</div>
            </div>
            <div class="admin-stats p-6 rounded-xl shadow-lg text-center">
                <div class="text-4xl font-bold text-green-600" id="activePets">0</div>
                <div class="text-gray-700 font-medium">Aktif Profil</div>
            </div>
            <div class="admin-stats p-6 rounded-xl shadow-lg text-center">
                <div class="text-4xl font-bold text-orange-600" id="totalViews">0</div>
                <div class="text-gray-700 font-medium">Toplam GÃ¶rÃ¼ntÃ¼lenme</div>
            </div>
            <div class="admin-stats p-6 rounded-xl shadow-lg text-center">
                <div class="text-4xl font-bold text-red-600" id="totalCalls">0</div>
                <div class="text-gray-700 font-medium">Toplam Arama</div>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow-lg">
            <div class="flex border-b">
                <button class="admin-tab-btn px-6 py-4 font-medium text-purple-600 border-b-2 border-purple-600" onclick="switchAdminTab('users')">
                    ğŸ‘¥ KullanÄ±cÄ±lar
                </button>
                <button class="admin-tab-btn px-6 py-4 font-medium text-gray-500 hover:text-purple-600" onclick="switchAdminTab('pets')">
                    ğŸ¾ Hayvanlar
                </button>
                <button class="admin-tab-btn px-6 py-4 font-medium text-gray-500 hover:text-purple-600" onclick="switchAdminTab('analytics')">
                    ğŸ“Š Analitik
                </button>
                <button class="admin-tab-btn px-6 py-4 font-medium text-gray-500 hover:text-purple-600" onclick="switchAdminTab('settings')">
                    âš™ï¸ Ayarlar
                </button>
            </div>

            <div id="usersTab" class="admin-tab-content p-6">
                <h3 class="text-xl font-semibold mb-4">KullanÄ±cÄ± Listesi</h3>
                <div class="overflow-x-auto">
                    <table class="w-full table-auto">
                        <thead>
                            <tr class="bg-gray-50">
                                <th class="px-4 py-2 text-left">UID</th>
                                <th class="px-4 py-2 text-left">Ad Soyad</th>
                                <th class="px-4 py-2 text-left">E-posta</th>
                                <th class="px-4 py-2 text-left">Telefon</th>
                                <th class="px-4 py-2 text-left">KayÄ±t Tarihi</th>
                                <th class="px-4 py-2 text-left">Hayvan SayÄ±sÄ±</th>
                                <th class="px-4 py-2 text-left">Ä°ÅŸlemler</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            </tbody>
                    </table>
                </div>
            </div>

            <div id="petsTab" class="admin-tab-content p-6 hidden">
                <h3 class="text-xl font-semibold mb-4">Hayvan Listesi</h3>
                <div class="overflow-x-auto">
                    <table class="w-full table-auto">
                        <thead>
                            <tr class="bg-gray-50">
                                <th class="px-4 py-2 text-left">ID</th>
                                <th class="px-4 py-2 text-left">Ad</th>
                                <th class="px-4 py-2 text-left">TÃ¼r</th>
                                <th class="px-4 py-2 text-left">Sahip</th>
                                <th class="px-4 py-2 text-left">GÃ¶rÃ¼ntÃ¼lenme</th>
                                <th class="px-4 py-2 text-left">Arama</th>
                                <th class="px-4 py-2 text-left">OluÅŸturulma</th>
                                <th class="px-4 py-2 text-left">Ä°ÅŸlemler</th>
                            </tr>
                        </thead>
                        <tbody id="petsTableBody">
                            </tbody>
                    </table>
                </div>
            </div>

            <div id="analyticsTab" class="admin-tab-content p-6 hidden">
                <h3 class="text-xl font-semibold mb-6">DetaylÄ± Analitik</h3>
                
                <div class="grid md:grid-cols-2 gap-6 mb-8">
                    <div class="bg-gradient-to-r from-blue-50 to-blue-100 p-6 rounded-xl">
                        <h4 class="text-lg font-semibold mb-4 text-blue-800">ğŸ“ˆ GÃ¼nlÃ¼k Ä°statistikler</h4>
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span>BugÃ¼n kayÄ±t olan:</span>
                                <span class="font-bold" id="todayRegistrations">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span>BugÃ¼n eklenen hayvan:</span>
                                <span class="font-bold" id="todayPets">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Toplam gÃ¶rÃ¼ntÃ¼lenme:</span>
                                <span class="font-bold" id="totalViews">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Toplam arama:</span>
                                <span class="font-bold" id="totalCalls">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-green-50 to-green-100 p-6 rounded-xl">
                        <h4 class="text-lg font-semibold mb-4 text-green-800">ğŸ† En PopÃ¼ler</h4>
                        <div class="space-y-2">
                            <div>
                                <span class="text-sm text-gray-600">En Ã§ok gÃ¶rÃ¼ntÃ¼lenen:</span>
                                <div class="font-bold" id="mostViewedPet">-</div>
                            </div>
                            <div>
                                <span class="text-sm text-gray-600">En Ã§ok aranan:</span>
                                <div class="font-bold" id="mostCalledPet">-</div>
                            </div>
                            <div>
                                <span class="text-sm text-gray-600">En aktif kullanÄ±cÄ±:</span>
                                <div class="font-bold" id="mostActivePetOwner">-</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-yellow-50 p-6 rounded-xl">
                    <h4 class="text-lg font-semibold mb-4 text-yellow-800">ğŸ“ Konum Verileri</h4>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-yellow-600" id="totalLocations">0</div>
                            <div class="text-sm text-gray-600">Toplam Konum</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-yellow-600" id="uniqueLocations">0</div>
                            <div class="text-sm text-gray-600">Benzersiz Konum</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-yellow-600" id="avgLocationsPerPet">0</div>
                            <div class="text-sm text-gray-600">Hayvan BaÅŸÄ±na Ort.</div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="settingsTab" class="admin-tab-content p-6 hidden">
                <h3 class="text-xl font-semibold mb-6">Sistem AyarlarÄ±</h3>
                
                <div class="space-y-6">
                    <div class="bg-blue-50 p-6 rounded-xl">
                        <h4 class="text-lg font-semibold mb-4 text-blue-800">ğŸ“ Ä°letiÅŸim Bilgileri</h4>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">SatÄ±ÅŸ Telefonu</label>
                                <input type="tel" id="salesPhone" value="05386694530" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Destek E-postasÄ±</label>
                                <input type="email" id="supportEmail" value="destek@patilink.com" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            </div>
                        </div>
                    </div>

                    <div class="bg-green-50 p-6 rounded-xl">
                        <h4 class="text-lg font-semibold mb-4 text-green-800">ğŸ’° FiyatlandÄ±rma & SatÄ±ÅŸ</h4>
                        <div class="grid md:grid-cols-2 gap-6 mb-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">NFC Tag FiyatÄ± (â‚º)</label>
                                <input type="number" id="nfcPrice" value="25" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Kargo Ãœcreti (â‚º)</label>
                                <input type="number" id="shippingPrice" value="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Pet Shop Komisyonu (%)</label>
                                <input type="number" id="commissionRate" value="15" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Minimum SipariÅŸ Adedi</label>
                                <input type="number" id="minOrderQuantity" value="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            </div>
                        </div>
                        
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Toplu SipariÅŸ Ä°ndirimi (%)</label>
                                <input type="number" id="bulkDiscount" value="10" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">10+ adet iÃ§in</p>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Ãœcretsiz Kargo Limiti (â‚º)</label>
                                <input type="number" id="freeShippingLimit" value="100" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            </div>
                        </div>
                    </div>

                    <div class="bg-purple-50 p-6 rounded-xl">
                        <h4 class="text-lg font-semibold mb-4 text-purple-800">ğŸ”§ Sistem AyarlarÄ±</h4>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <span>Yeni kayÄ±tlara izin ver</span>
                                <input type="checkbox" id="allowRegistrations" checked class="w-5 h-5">
                            </div>
                            <div class="flex items-center justify-between">
                                <span>E-posta bildirimleri</span>
                                <input type="checkbox" id="emailNotifications" checked class="w-5 h-5">
                            </div>
                            <div class="flex items-center justify-between">
                                <span>SMS bildirimleri</span>
                                <input type="checkbox" id="smsNotifications" class="w-5 h-5">
                            </div>
                            <div class="flex items-center justify-between">
                                <span>BakÄ±m modu</span>
                                <input type="checkbox" id="maintenanceMode" class="w-5 h-5">
                            </div>
                        </div>
                    </div>

                    <div class="danger-zone p-6 rounded-xl">
                        <h4 class="text-lg font-semibold mb-4 text-white">âš ï¸ Tehlikeli Ä°ÅŸlemler</h4>
                        <div class="space-y-4">
                            <button onclick="exportData()" class="bg-white text-red-600 hover:bg-gray-100 px-4 py-2 rounded-lg font-medium">
                                ğŸ“¥ TÃ¼m Verileri DÄ±ÅŸa Aktar
                            </button>
                            <button onclick="clearOldData()" class="bg-white text-red-600 hover:bg-gray-100 px-4 py-2 rounded-lg font-medium ml-4">
                                ğŸ—‘ï¸ Eski Verileri Temizle
                            </button>
                            <button onclick="resetSystem()" class="bg-white text-red-600 hover:bg-gray-100 px-4 py-2 rounded-lg font-medium ml-4">
                                ğŸ”„ Sistemi SÄ±fÄ±rla
                            </button>
                        </div>
                    </div>

                    <div class="text-center">
                        <button onclick="saveSettings()" class="bg-purple-600 hover:bg-purple-700 text-white px-8 py-3 rounded-lg font-medium">
                            ğŸ’¾ AyarlarÄ± Kaydet
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="petProfileView" class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 hidden">
        <div id="petProfileContent">
            </div>
    </div>

    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 modal hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4">
            <h3 class="text-2xl font-bold mb-6 text-center">GiriÅŸ Yap</h3>
            <form id="loginForm">
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2">E-posta</label>
                    <input type="email" class="form-input w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" required>
                </div>
                <div class="mb-6">
                    <label class="block text-gray-700 text-sm font-bold mb-2">Åifre</label>
                    <input type="password" class="form-input w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" required>
                </div>
                <button type="submit" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg">
                    GiriÅŸ Yap
                </button>
            </form>
            <button id="closeLoginModal" class="mt-4 w-full text-gray-500 hover:text-gray-700">Ä°ptal</button>
        </div>
    </div>

    <div id="registerModal" class="fixed inset-0 bg-black bg-opacity-50 modal hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4">
            <h3 class="text-2xl font-bold mb-6 text-center">Ãœye Ol</h3>
            <form id="registerForm">
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2">Ad Soyad</label>
                    <input type="text" class="form-input w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2">E-posta</label>
                    <input type="email" class="form-input w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2">Telefon</label>
                    <input type="tel" class="form-input w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" required>
                </div>
                <div class="mb-6">
                    <label class="block text-gray-700 text-sm font-bold mb-2">Åifre</label>
                    <input type="password" class="form-input w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" required>
                </div>
                <button type="submit" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg">
                    Ãœye Ol
                </button>
            </form>
            <button id="closeRegisterModal" class="mt-4 w-full text-gray-500 hover:text-gray-700">Ä°ptal</button>
        </div>
    </div>

    <div id="addPetModal" class="fixed inset-0 bg-black bg-opacity-50 modal hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <h3 class="text-3xl font-bold mb-8 text-center">ğŸ¾ Yeni Hayvan Profili OluÅŸtur</h3>
            
            <div class="flex mb-8 bg-gray-100 rounded-lg p-1">
                <button type="button" class="tab-button flex-1 py-2 px-4 rounded-md text-sm font-medium active" onclick="switchTab('basic')">
                    ğŸ“ Temel Bilgiler
                </button>
                <button type="button" class="tab-button flex-1 py-2 px-4 rounded-md text-sm font-medium" onclick="switchTab('media')">
                    ğŸ“¸ Medya & Sosyal
                </button>
                <button type="button" class="tab-button flex-1 py-2 px-4 rounded-md text-sm font-medium" onclick="switchTab('health')">
                    ğŸ¥ SaÄŸlÄ±k & Veteriner
                </button>
                <button type="button" class="tab-button flex-1 py-2 px-4 rounded-md text-sm font-medium" onclick="switchTab('extra')">
                    â• Ek Bilgiler
                </button>
            </div>

            <form id="addPetForm">
                <div id="basicTab" class="tab-content">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Hayvan AdÄ± *</label>
                            <input type="text" name="petName" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" required placeholder="Ã–rn: Karamel">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">TÃ¼r *</label>
                            <select name="petType" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" required>
                                <option value="">SeÃ§iniz</option>
                                <option value="kÃ¶pek">ğŸ• KÃ¶pek</option>
                                <option value="kedi">ğŸ± Kedi</option>
                                <option value="kuÅŸ">ğŸ¦ KuÅŸ</option>
                                <option value="hamster">ğŸ¹ Hamster</option>
                                <option value="tavÅŸan">ğŸ° TavÅŸan</option>
                                <option value="balÄ±k">ğŸ  BalÄ±k</option>
                                <option value="diÄŸer">ğŸ¾ DiÄŸer</option>
                            </select>
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Cinsi</label>
                            <input type="text" name="breed" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Ã–rn: Golden Retriever">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">DoÄŸum Tarihi</label>
                            <input type="date" name="birthDate" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Cinsiyet</label>
                            <select name="gender" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500">
                                <option value="">SeÃ§iniz</option>
                                <option value="erkek">â™‚ï¸ Erkek</option>
                                <option value="diÅŸi">â™€ï¸ DiÅŸi</option>
                            </select>
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Renk/Desen</label>
                            <input type="text" name="color" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Ã–rn: AltÄ±n sarÄ±sÄ±, beyaz gÃ¶ÄŸÃ¼slÃ¼">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">AÄŸÄ±rlÄ±k (kg)</label>
                            <input type="number" name="weight" step="0.1" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Ã–rn: 25.5">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">MikroÃ§ip NumarasÄ±</label>
                            <input type="text" name="microchip" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="15 haneli mikroÃ§ip numarasÄ±">
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Genel AÃ§Ä±klama</label>
                        <textarea name="description" rows="4" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="HayvanÄ±nÄ±zÄ±n karakteri, alÄ±ÅŸkanlÄ±klarÄ±, sevdiÄŸi ÅŸeyler..."></textarea>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">KÄ±sÄ±rlaÅŸtÄ±rma Durumu</label>
                            <select name="neutered" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500">
                                <option value="">SeÃ§iniz</option>
                                <option value="evet">âœ… KÄ±sÄ±rlaÅŸtÄ±rÄ±ldÄ±</option>
                                <option value="hayÄ±r">âŒ KÄ±sÄ±rlaÅŸtÄ±rÄ±lmadÄ±</option>
                            </select>
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Ã‡ocuklarla Ä°liÅŸkisi</label>
                            <select name="childFriendly" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500">
                                <option value="">SeÃ§iniz</option>
                                <option value="Ã§ok-iyi">ğŸ˜ Ã‡ok iyi</option>
                                <option value="iyi">ğŸ˜Š Ä°yi</option>
                                <option value="orta">ğŸ˜ Orta</option>
                                <option value="dikkatli">âš ï¸ Dikkatli olunmalÄ±</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div id="mediaTab" class="tab-content hidden">
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Profil FotoÄŸrafÄ±</label>
                        <input type="url" name="photo" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500 mb-2" placeholder="Ana profil fotoÄŸrafÄ± URL'si">
                        <p class="text-sm text-gray-500">Ana profil fotoÄŸrafÄ± olarak kullanÄ±lacak</p>
                    </div>

                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Ek FotoÄŸraflar</label>
                        <div id="photoGallery" class="mb-4">
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4" id="photoList">
                                </div>
                        </div>
                        <div class="flex gap-2">
                            <input type="url" id="newPhotoUrl" class="form-input flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="FotoÄŸraf URL'si ekle">
                            <button type="button" onclick="addPhoto()" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-3 rounded-lg">Ekle</button>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Video Linkleri</label>
                        <div id="videoList" class="space-y-2 mb-4">
                            </div>
                        <div class="flex gap-2">
                            <input type="url" id="newVideoUrl" class="form-input flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="YouTube, Instagram video linki">
                            <button type="button" onclick="addVideo()" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-3 rounded-lg">Ekle</button>
                        </div>
                    </div>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Instagram Profili</label>
                            <input type="url" name="instagram" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="https://instagram.com/username">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Facebook Profili</label>
                            <input type="url" name="facebook" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="https://facebook.com/username">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">TikTok Profili</label>
                            <input type="url" name="tiktok" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="https://tiktok.com/@username">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">YouTube KanalÄ±</label>
                            <input type="url" name="youtube" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="https://youtube.com/channel/...">
                        </div>
                    </div>
                </div>

                <div id="healthTab" class="tab-content hidden">
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">SaÄŸlÄ±k Durumu</label>
                        <textarea name="health" rows="4" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Kronik hastalÄ±klar, alerjiler, sÃ¼rekli kullandÄ±ÄŸÄ± ilaÃ§lar..."></textarea>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Son AÅŸÄ± Tarihi</label>
                            <input type="date" name="lastVaccination" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Sonraki AÅŸÄ± Tarihi</label>
                            <input type="date" name="nextVaccination" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500">
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Veteriner Bilgileri</label>
                        <div class="grid md:grid-cols-2 gap-4">
                            <input type="text" name="vetName" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Veteriner adÄ±">
                            <input type="tel" name="vetPhone" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Veteriner telefonu">
                        </div>
                        <input type="text" name="vetAddress" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500 mt-2" placeholder="Veteriner adresi">
                    </div>

                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Acil Durum TalimatlarÄ±</label>
                        <textarea name="emergencyInstructions" rows="3" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Acil durumda yapÄ±lmasÄ± gerekenler, Ã¶zel talimatlar..."></textarea>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Kan Grubu</label>
                            <input type="text" name="bloodType" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Kan grubu (biliniyorsa)">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Sigorta Bilgileri</label>
                            <input type="text" name="insurance" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Pet sigortasÄ± var mÄ±?">
                        </div>
                    </div>
                </div>

                <div id="extraTab" class="tab-content hidden">
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Beslenme Bilgileri</label>
                        <textarea name="feeding" rows="3" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Mama markasÄ±, beslenme saatleri, Ã¶zel diyet..."></textarea>
                    </div>

                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">DavranÄ±ÅŸ Ã–zellikleri</label>
                        <textarea name="behavior" rows="3" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Karakteri, alÄ±ÅŸkanlÄ±klarÄ±, korkularÄ±, sevdiÄŸi oyunlar..."></textarea>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Favori OyuncaÄŸÄ±</label>
                            <input type="text" name="favoriteToy" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="En sevdiÄŸi oyuncak">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Favori YemeÄŸi</label>
                            <input type="text" name="favoriteFood" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="En sevdiÄŸi yemek/Ã¶dÃ¼l">
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Ã–zel Notlar</label>
                        <textarea name="specialNotes" rows="3" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Bulan kiÅŸinin bilmesi gereken Ã¶zel durumlar..."></textarea>
                    </div>

                    <div id="customFields" class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Ã–zel Alanlar</label>
                        <div id="customFieldsList" class="space-y-2 mb-4">
                            </div>
                        <button type="button" id="addCustomField" class="text-purple-600 hover:text-purple-800 text-sm font-medium">+ Yeni Alan Ekle</button>
                    </div>
                </div>
                
                <div class="flex gap-4 mt-8">
                    <button type="submit" class="flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-3 px-6 rounded-lg text-lg">
                        ğŸ¾ Profili OluÅŸtur
                    </button>
                    <button type="button" id="closeAddPetModal" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 font-bold py-3 px-6 rounded-lg text-lg" onclick="hideModal('addPetModal')">
                        Ä°ptal
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="editPetModal" class="fixed inset-0 bg-black bg-opacity-50 modal hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <h3 class="text-3xl font-bold mb-8 text-center">âœï¸ Hayvan Profilini DÃ¼zenle</h3>
            
            <div class="flex mb-8 bg-gray-100 rounded-lg p-1">
                <button type="button" class="edit-tab-button flex-1 py-2 px-4 rounded-md text-sm font-medium active" onclick="switchEditTab('basic')">
                    ğŸ“ Temel Bilgiler
                </button>
                <button type="button" class="edit-tab-button flex-1 py-2 px-4 rounded-md text-sm font-medium" onclick="switchEditTab('media')">
                    ğŸ“¸ Medya & Sosyal
                </button>
                <button type="button" class="edit-tab-button flex-1 py-2 px-4 rounded-md text-sm font-medium" onclick="switchEditTab('health')">
                    ğŸ¥ SaÄŸlÄ±k & Veteriner
                </button>
                <button type="button" class="edit-tab-button flex-1 py-2 px-4 rounded-md text-sm font-medium" onclick="switchEditTab('extra')">
                    â• Ek Bilgiler
                </button>
            </div>

            <form id="editPetForm">
                <input type="hidden" id="editPetId" name="petId">
                
                <div id="editBasicTab" class="edit-tab-content">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Hayvan AdÄ± *</label>
                            <input type="text" name="petName" id="editPetName" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" required placeholder="Ã–rn: Karamel">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">TÃ¼r *</label>
                            <select name="petType" id="editPetType" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" required>
                                <option value="">SeÃ§iniz</option>
                                <option value="kÃ¶pek">ğŸ• KÃ¶pek</option>
                                <option value="kedi">ğŸ± Kedi</option>
                                <option value="kuÅŸ">ğŸ¦ KuÅŸ</option>
                                <option value="hamster">ğŸ¹ Hamster</option>
                                <option value="tavÅŸan">ğŸ° TavÅŸan</option>
                                <option value="balÄ±k">ğŸ  BalÄ±k</option>
                                <option value="diÄŸer">ğŸ¾ DiÄŸer</option>
                            </select>
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Cinsi</label>
                            <input type="text" name="breed" id="editBreed" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Ã–rn: Golden Retriever">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">DoÄŸum Tarihi</label>
                            <input type="date" name="birthDate" id="editBirthDate" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Cinsiyet</label>
                            <select name="gender" id="editGender" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500">
                                <option value="">SeÃ§iniz</option>
                                <option value="erkek">â™‚ï¸ Erkek</option>
                                <option value="diÅŸi">â™€ï¸ DiÅŸi</option>
                            </select>
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Renk/Desen</label>
                            <input type="text" name="color" id="editColor" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Ã–rn: AltÄ±n sarÄ±sÄ±, beyaz gÃ¶ÄŸÃ¼slÃ¼">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">AÄŸÄ±rlÄ±k (kg)</label>
                            <input type="number" name="weight" id="editWeight" step="0.1" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Ã–rn: 25.5">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">MikroÃ§ip NumarasÄ±</label>
                            <input type="text" name="microchip" id="editMicrochip" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="15 haneli mikroÃ§ip numarasÄ±">
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Genel AÃ§Ä±klama</label>
                        <textarea name="description" id="editDescription" rows="4" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="HayvanÄ±nÄ±zÄ±n karakteri, alÄ±ÅŸkanlÄ±klarÄ±, sevdiÄŸi ÅŸeyler..."></textarea>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">KÄ±sÄ±rlaÅŸtÄ±rma Durumu</label>
                            <select name="neutered" id="editNeutered" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500">
                                <option value="">SeÃ§iniz</option>
                                <option value="evet">âœ… KÄ±sÄ±rlaÅŸtÄ±rÄ±ldÄ±</option>
                                <option value="hayÄ±r">âŒ KÄ±sÄ±rlaÅŸtÄ±rÄ±lmadÄ±</option>
                            </select>
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Ã‡ocuklarla Ä°liÅŸkisi</label>
                            <select name="childFriendly" id="editChildFriendly" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500">
                                <option value="">SeÃ§iniz</option>
                                <option value="Ã§ok-iyi">ğŸ˜ Ã‡ok iyi</option>
                                <option value="iyi">ğŸ˜Š Ä°yi</option>
                                <option value="orta">ğŸ˜ Orta</option>
                                <option value="dikkatli">âš ï¸ Dikkatli olunmalÄ±</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div id="editMediaTab" class="edit-tab-content hidden">
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Profil FotoÄŸrafÄ±</label>
                        <input type="url" name="photo" id="editPhoto" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500 mb-2" placeholder="Ana profil fotoÄŸrafÄ± URL'si">
                        <p class="text-sm text-gray-500">Ana profil fotoÄŸrafÄ± olarak kullanÄ±lacak</p>
                    </div>

                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Ek FotoÄŸraflar</label>
                        <div id="editPhotoGallery" class="mb-4">
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4" id="editPhotoList">
                                </div>
                        </div>
                        <div class="flex gap-2">
                            <input type="url" id="editNewPhotoUrl" class="form-input flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="FotoÄŸraf URL'si ekle">
                            <button type="button" onclick="addEditPhoto()" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-3 rounded-lg">Ekle</button>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Video Linkleri</label>
                        <div id="editVideoList" class="space-y-2 mb-4">
                            </div>
                        <div class="flex gap-2">
                            <input type="url" id="editNewVideoUrl" class="form-input flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="YouTube, Instagram video linki">
                            <button type="button" onclick="addEditVideo()" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-3 rounded-lg">Ekle</button>
                        </div>
                    </div>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Instagram Profili</label>
                            <input type="url" name="instagram" id="editInstagram" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="https://instagram.com/username">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Facebook Profili</label>
                            <input type="url" name="facebook" id="editFacebook" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="https://facebook.com/username">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">TikTok Profili</label>
                            <input type="url" name="tiktok" id="editTiktok" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="https://tiktok.com/@username">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">YouTube KanalÄ±</label>
                            <input type="url" name="youtube" id="editYoutube" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="https://youtube.com/channel/...">
                        </div>
                    </div>
                </div>

                <div id="editHealthTab" class="edit-tab-content hidden">
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">SaÄŸlÄ±k Durumu</label>
                        <textarea name="health" id="editHealth" rows="4" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Kronik hastalÄ±klar, alerjiler, sÃ¼rekli kullandÄ±ÄŸÄ± ilaÃ§lar..."></textarea>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Son AÅŸÄ± Tarihi</label>
                            <input type="date" name="lastVaccination" id="editLastVaccination" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Sonraki AÅŸÄ± Tarihi</label>
                            <input type="date" name="nextVaccination" id="editNextVaccination" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500">
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Veteriner Bilgileri</label>
                        <div class="grid md:grid-cols-2 gap-4">
                            <input type="text" name="vetName" id="editVetName" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Veteriner adÄ±">
                            <input type="tel" name="vetPhone" id="editVetPhone" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Veteriner telefonu">
                        </div>
                        <input type="text" name="vetAddress" id="editVetAddress" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500 mt-2" placeholder="Veteriner adresi">
                    </div>

                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Acil Durum TalimatlarÄ±</label>
                        <textarea name="emergencyInstructions" id="editEmergencyInstructions" rows="3" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Acil durumda yapÄ±lmasÄ± gerekenler, Ã¶zel talimatlar..."></textarea>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Kan Grubu</label>
                            <input type="text" name="bloodType" id="editBloodType" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Kan grubu (biliniyorsa)">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Sigorta Bilgileri</label>
                            <input type="text" name="insurance" id="editInsurance" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Pet sigortasÄ± var mÄ±?">
                        </div>
                    </div>
                </div>

                <div id="editExtraTab" class="edit-tab-content hidden">
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Beslenme Bilgileri</label>
                        <textarea name="feeding" id="editFeeding" rows="3" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Mama markasÄ±, beslenme saatleri, Ã¶zel diyet..."></textarea>
                    </div>

                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">DavranÄ±ÅŸ Ã–zellikleri</label>
                        <textarea name="behavior" id="editBehavior" rows="3" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Karakteri, alÄ±ÅŸkanlÄ±klarÄ±, korkularÄ±, sevdiÄŸi oyunlar..."></textarea>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Favori OyuncaÄŸÄ±</label>
                            <input type="text" name="favoriteToy" id="editFavoriteToy" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="En sevdiÄŸi oyuncak">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Favori YemeÄŸi</label>
                            <input type="text" name="favoriteFood" id="editFavoriteFood" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="En sevdiÄŸi yemek/Ã¶dÃ¼l">
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Ã–zel Notlar</label>
                        <textarea name="specialNotes" id="editSpecialNotes" rows="3" class="form-input w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" placeholder="Bulan kiÅŸinin bilmesi gereken Ã¶zel durumlar..."></textarea>
                    </div>

                    <div id="editCustomFields" class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Ã–zel Alanlar</label>
                        <div id="editCustomFieldsList" class="space-y-2 mb-4">
                            </div>
                        <button type="button" id="addEditCustomField" class="text-purple-600 hover:text-purple-800 text-sm font-medium">+ Yeni Alan Ekle</button>
                    </div>
                </div>
                
                <div class="flex gap-4 mt-8">
                    <button type="submit" class="flex-1 bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 text-white font-bold py-3 px-6 rounded-lg text-lg">
                        ğŸ’¾ DeÄŸiÅŸiklikleri Kaydet
                    </button>
                    <button type="button" id="closeEditPetModal" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 font-bold py-3 px-6 rounded-lg text-lg" onclick="hideModal('editPetModal')">
                        Ä°ptal
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="notificationContainer" class="fixed top-4 right-4 z-50 space-y-2">
        </div>

    <script>
        // === FIREBASE CONFIGURATION (BAÅLANGIÃ‡) ===
        // Bu konfigÃ¼rasyon Firebase projenizle iletiÅŸim kurmak iÃ§in KRÄ°TÄ°KTÄ°R.
        const firebaseConfig = {
            apiKey: "AIzaSyCZSnh9jWibR4a0Pc6RKBDYlGZNXP_Tiu8",
            authDomain: "petnfc-46178.firebaseapp.com",
            projectId: "petnfc-46178",
            storageBucket: "petnfc-46178.firebasestorage.app",
            messagingSenderId: "942096749783",
            appId: "1:942096749783:web:afcd7f8e4f4f109f3c4c92",
            measurementId: "G-XS8LXGR545"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Global state tanÄ±mlarÄ±
        let currentUser = null; 
        let pets = [];          
        let currentPet = null;
        let photoGallery = [];
        let videoGallery = [];
        let editPhotoGallery = [];
        let editVideoGallery = [];
        
        // Admin ayarlarÄ± (local storage'da kalabilir)
        let adminSettings = JSON.parse(localStorage.getItem('patilink_admin_settings') || '{ "salesPhone": "05386694530", "supportEmail": "destek@patilink.com", "nfcPrice": 25, "shippingPrice": 0, "commissionRate": 15, "minOrderQuantity": 1, "bulkDiscount": 10, "freeShippingLimit": 100, "allowRegistrations": true, "emailNotifications": true, "smsNotifications": false, "maintenanceMode": false }');

        // UI YÃ¶nlendirme FonksiyonlarÄ± (Firebase Listener'dan Ã¶nce tanÄ±mlanmalÄ±)
        function showUserDashboard() {
            document.getElementById('welcomeSection').classList.add('hidden');
            document.getElementById('userDashboard').classList.remove('hidden');
            document.getElementById('petProfileView').classList.add('hidden');
            document.getElementById('adminDashboard').classList.add('hidden');
            
            updateNavigation();
            renderPetsList();
        }

        function showWelcomeSection() {
            document.getElementById('welcomeSection').classList.remove('hidden');
            document.getElementById('userDashboard').classList.add('hidden');
            document.getElementById('petProfileView').classList.add('hidden');
            document.getElementById('adminDashboard').classList.add('hidden');
            
            window.history.replaceState({}, document.title, window.location.pathname);
        }

        // Helper function to show notifications
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification bg-white border-l-4 p-4 rounded-lg shadow-lg max-w-sm ${
                type === 'success' ? 'border-green-500' : 
                type === 'error' ? 'border-red-500' : 
                'border-blue-500'
            }`;
            
            notification.innerHTML = `
                <div class="flex items-center">
                    <div class="flex-1">
                        <p class="text-sm font-medium text-gray-900">${message}</p>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-gray-400 hover:text-gray-600">
                        <span class="sr-only">Close</span>
                        Ã—
                    </button>
                </div>
            `;
            
            document.getElementById('notificationContainer').appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }

        // DiÄŸer Helper Fonksiyonlar
        function calculateAge(birthDate) {
            const birth = new Date(birthDate);
            const today = new Date();
            const diffTime = Math.abs(today - birth);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays < 30) {
                return `${diffDays} gÃ¼n`;
            } else if (diffDays < 365) {
                const months = Math.floor(diffDays / 30);
                return `${months} ay`;
            } else {
                const years = Math.floor(diffDays / 365);
                const remainingMonths = Math.floor((diffDays % 365) / 30);
                return remainingMonths > 0 ? `${years} yaÅŸ ${remainingMonths} ay` : `${years} yaÅŸ`;
            }
        }
        function getAnimalEmoji(type) {
            const emojis = { 'kÃ¶pek': 'ğŸ•', 'kedi': 'ğŸ±', 'kuÅŸ': 'ğŸ¦', 'hamster': 'ğŸ¹', 'tavÅŸan': 'ğŸ°', 'balÄ±k': 'ğŸ ', 'diÄŸer': 'ğŸ¾' };
            return emojis[type] || 'ğŸ¾';
        }
        function showModal(modalId) { document.getElementById(modalId).classList.remove('hidden'); }
        function hideModal(modalId) { document.getElementById(modalId).classList.add('hidden'); }
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tabName + 'Tab').classList.remove('hidden');
            event.target.classList.add('active');
        }
        function switchEditTab(tabName) {
             document.querySelectorAll('.edit-tab-content').forEach(tab => tab.classList.add('hidden'));
            document.querySelectorAll('.edit-tab-button').forEach(btn => btn.classList.remove('active'));
            document.getElementById('edit' + tabName.charAt(0).toUpperCase() + tabName.slice(1) + 'Tab').classList.remove('hidden');
            event.target.classList.add('active');
        }
        
        // Galeri YÃ¶netimi FonksiyonlarÄ± (Ã–rnekleri korundu)
        function addPhoto() {
            const url = document.getElementById('newPhotoUrl').value.trim();
            if (url) { photoGallery.push(url); updatePhotoGallery(); document.getElementById('newPhotoUrl').value = ''; }
        }
        function removePhoto(index) { photoGallery.splice(index, 1); updatePhotoGallery(); }
        function updatePhotoGallery() { /* ... gallery update logic ... */ }
        function addVideo() {
            const url = document.getElementById('newVideoUrl').value.trim();
            if (url) { videoGallery.push(url); updateVideoGallery(); document.getElementById('newVideoUrl').value = ''; }
        }
        function removeVideo(index) { videoGallery.splice(index, 1); updateVideoGallery(); }
        function updateVideoGallery() { /* ... video update logic ... */ }
        // DiÄŸer galeri/custom field fonksiyonlarÄ± da buraya gelir.
        function updateEditPhotoGallery() { /* ... logic ... */ }
        function addEditPhoto() { /* ... logic ... */ }
        function removeEditPhoto(index) { editPhotoGallery.splice(index, 1); updateEditPhotoGallery(); }
        function updateEditVideoGallery() { /* ... logic ... */ }
        function addEditVideo() { /* ... logic ... */ }
        function removeEditVideo(index) { editVideoGallery.splice(index, 1); updateEditVideoGallery(); }
        function addCustomField() {
            const customFieldsList = document.getElementById('customFieldsList');
            const fieldDiv = document.createElement('div');
            fieldDiv.className = 'flex gap-2';
            fieldDiv.innerHTML = `<input type="text" placeholder="Alan adÄ±" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg"><input type="text" placeholder="DeÄŸer" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg"><button type="button" onclick="this.parentElement.remove()" class="bg-red-500 text-white px-3 py-2 rounded-lg hover:bg-red-600">Ã—</button>`;
            customFieldsList.appendChild(fieldDiv);
        }
        function addEditCustomField() { /* ... logic ... */ }

        // --- FIREBASE CORE FUNCTIONS ---

        // YENÄ°: Firestore'dan kullanÄ±cÄ±nÄ±n petlerini ve admin ayarlarÄ±nÄ± Ã§eker
        async function fetchUserDataAndShowDashboard(userId) {
            try {
                const userDoc = await db.collection('users').doc(userId).get();
                
                if (userDoc.exists) {
                    // Firestore'da kullanÄ±cÄ± detaylarÄ± varsa, Auth objesiyle birleÅŸtir
                    currentUser = { ...auth.currentUser, ...userDoc.data() };
                } else {
                    // Firestore kaydÄ± yoksa (eski kullanÄ±cÄ±lar veya kayÄ±t hatasÄ±), sadece Auth bilgisini kullan
                    currentUser = auth.currentUser;
                    currentUser.name = currentUser.email; 
                    currentUser.phone = 'Bilinmiyor';
                }

                // Petler ve Ä°statistikler
                const snapshot = await db.collection('pets').where('ownerId', '==', userId).get();
                pets = [];
                snapshot.forEach(doc => {
                    pets.push({ id: doc.id, ...doc.data() });
                });
                
                showUserDashboard();
            } catch (error) {
                console.error("Veri Ã§ekilirken hata:", error);
                showNotification('Veri senkronizasyonu hatasÄ±: ' + error.message, 'error');
                showUserDashboard();
            }
        }
        
        // DÃœZELTÄ°LDÄ°: KayÄ±t Ä°ÅŸlemi
        async function handleRegister(e) {
            e.preventDefault();
            const name = e.target.elements[0].value;
            const email = e.target.elements[1].value;
            const phone = e.target.elements[2].value;
            const password = e.target.elements[3].value;
            
            try {
                // 1. Firebase Auth ile kullanÄ±cÄ± oluÅŸtur
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                const user = userCredential.user;
                
                // 2. Firestore'a ek kullanÄ±cÄ± bilgilerini kaydet
                await db.collection('users').doc(user.uid).set({
                    name: name,
                    email: email,
                    phone: phone,
                    registrationDate: firebase.firestore.FieldValue.serverTimestamp()
                });

                hideModal('registerModal');
                showNotification('KayÄ±t baÅŸarÄ±lÄ±! GiriÅŸ yapÄ±lÄ±yor...', 'success');
                document.getElementById('registerForm').reset();
            } catch (error) {
                showNotification(`KayÄ±t hatasÄ±: ${error.message}`, 'error');
            }
        }
        
        // DÃœZELTÄ°LDÄ°: GiriÅŸ Ä°ÅŸlemi
        async function handleLogin(e) {
            e.preventDefault();
            const email = e.target.elements[0].value;
            const password = e.target.elements[1].value;

            try {
                await auth.signInWithEmailAndPassword(email, password);
                hideModal('loginModal');
                showNotification('GiriÅŸ baÅŸarÄ±lÄ±!', 'success');
            } catch (error) {
                showNotification(`GiriÅŸ hatasÄ±: ${error.message}`, 'error');
            }
        }

        // YENÄ°: Oturum Kapatma
        function logout() {
            auth.signOut().then(() => {
                showNotification('BaÅŸarÄ±yla Ã§Ä±kÄ±ÅŸ yapÄ±ldÄ±.', 'info');
            }).catch(error => {
                showNotification('Ã‡Ä±kÄ±ÅŸ hatasÄ±: ' + error.message, 'error');
            });
        }
        
        // YENÄ°: Hayvan Ekleme
        async function handleAddPet(e) {
            e.preventDefault();
            if (!currentUser) { showNotification('GiriÅŸ yapÄ±nÄ±z.', 'error'); return; }

            const formData = new FormData(e.target);
            const customFields = [];
            const customFieldsDiv = document.getElementById('customFieldsList');
            const customFieldInputs = customFieldsDiv.querySelectorAll('div');
            customFieldInputs.forEach(div => {
                const inputs = div.querySelectorAll('input');
                if (inputs.length === 2 && inputs[0].value && inputs[1].value) {
                    customFields.push({ label: inputs[0].value, value: inputs[1].value });
                }
            });

            const newPetData = {
                name: formData.get('petName'),
                type: formData.get('petType'),
                // ... diÄŸer form verileri ...
                photoGallery: [...photoGallery],
                videoGallery: [...videoGallery],
                customFields: customFields,
                
                ownerId: currentUser.uid, 
                owner: { name: currentUser.name, email: currentUser.email, phone: currentUser.phone },
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                stats: { views: 0, calls: 0, locations: [] }
            };

            try {
                const docRef = await db.collection('pets').add(newPetData);
                const updatedLink = `${window.location.origin}${window.location.pathname}?pet=${docRef.id}`;
                await docRef.update({ link: updatedLink });

                hideModal('addPetModal');
                showNotification('Profil oluÅŸturuldu ve senkronize edildi!', 'success');
                fetchUserDataAndShowDashboard(currentUser.uid);
                e.target.reset(); 
            } catch (error) {
                showNotification(`Profil oluÅŸturma hatasÄ±: ${error.message}`, 'error');
            }
        }

        // DÃœZELTÄ°LDÄ°: Hayvan DÃ¼zenleme
        async function handleEditPet(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const petId = formData.get('petId'); 

            // Custom fields'Ä± topla (editCustomFieldsList'ten)
            const customFields = []; 
            // ... (Custom field toplama mantÄ±ÄŸÄ± burada)

            const updatedData = {
                // ... tÃ¼m gÃ¼ncellenecek alanlar ...
                photoGallery: [...editPhotoGallery],
                videoGallery: [...editVideoGallery],
                customFields: customFields
            };

            try {
                await db.collection('pets').doc(petId).update(updatedData);
                hideModal('editPetModal');
                showNotification('Hayvan profili gÃ¼ncellendi ve senkronize edildi!', 'success');
                fetchUserDataAndShowDashboard(currentUser.uid);
            } catch (error) {
                showNotification(`GÃ¼ncelleme hatasÄ±: ${error.message}`, 'error');
            }
        }
        
        // DÃœZELTÄ°LDÄ°: Hayvan Silme
        function deletePet(petId) {
            db.collection('pets').doc(petId).delete()
                .then(() => {
                    showNotification('Hayvan profili silindi ve senkronize edildi!', 'success');
                    pets = pets.filter(p => p.id !== petId); 
                    renderPetsList();
                })
                .catch(error => {
                    showNotification(`Silme hatasÄ±: ${error.message}`, 'error');
                });
        }
        
        // DÃœZELTÄ°LDÄ°: Harici Profil GÃ¶rÃ¼ntÃ¼leme (QR/NFC Tarama)
        async function showPetProfile(petId) {
            try {
                const doc = await db.collection('pets').doc(petId).get();
                if (!doc.exists) {
                    showNotification('Hayvan profili bulunamadÄ±!', 'error');
                    showWelcomeSection();
                    return;
                }

                const foundPet = { id: doc.id, ...doc.data() };
                const newViews = (foundPet.stats.views || 0) + 1;
                await db.collection('pets').doc(petId).update({ 'stats.views': newViews });

                document.getElementById('welcomeSection').classList.add('hidden');
                document.getElementById('userDashboard').classList.add('hidden');
                document.getElementById('adminDashboard').classList.add('hidden');
                document.getElementById('petProfileView').classList.remove('hidden');
                
                // Pet profilini render et (stats gÃ¼ncellenmiÅŸ pet objesini kullan)
                renderPetProfile(foundPet, foundPet.owner.email);
            } catch (error) {
                console.error("Profil yÃ¼klenemedi:", error);
                showNotification('Profil yÃ¼klenemedi. Hata: ' + error.message, 'error');
                showWelcomeSection();
            }
        }
        
        // DÃœZELTÄ°LDÄ°: Konum PaylaÅŸma
        function shareLocation(petId) {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const location = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude,
                            timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                            accuracy: position.coords.accuracy
                        };
                        
                        db.collection('pets').doc(petId).update({
                            'stats.locations': firebase.firestore.FieldValue.arrayUnion(location)
                        })
                        .then(() => {
                            showNotification('Konum baÅŸarÄ±yla paylaÅŸÄ±ldÄ±! Sahip bilgilendirildi.', 'success');
                        })
                        .catch(error => {
                            showNotification('Konum kaydedilemedi: ' + error.message, 'error');
                        });
                    },
                    (error) => {
                        showNotification('Konum alÄ±namadÄ±. LÃ¼tfen konum izni verin.', 'error');
                    }
                );
            } else {
                showNotification('TarayÄ±cÄ±nÄ±z konum paylaÅŸÄ±mÄ±nÄ± desteklemiyor.', 'error');
            }
        }
        
        // DÃœZELTÄ°LDÄ°: Sahibini Arama
        function callOwner(phone, petId) {
            db.collection('pets').doc(petId).get().then(doc => {
                if (doc.exists) {
                    const petData = doc.data();
                    const newCalls = (petData.stats.calls || 0) + 1;
                    db.collection('pets').doc(petId).update({ 'stats.calls': newCalls });
                }
            });
            window.open(`tel:${phone}`, '_blank');
        }

        // DÃœZELTÄ°LDÄ°: Admin Panel FonksiyonlarÄ± (Firebase'den veri Ã§eker)
        // DÄ°KKAT: Firestore kurallarÄ±nÄ±z tÃ¼m koleksiyonlarÄ± okumaya izin vermiyorsa, bu fonksiyonlar "Permission Denied" hatasÄ± verecektir.
        async function updateAdminStats() {
            try {
                const usersSnapshot = await db.collection('users').get();
                const petsSnapshot = await db.collection('pets').get();
                
                let totalViews = 0;
                let totalCalls = 0;
                let activePets = 0;
                
                petsSnapshot.forEach(petDoc => {
                    const stats = petDoc.data().stats || { views: 0, calls: 0 };
                    totalViews += stats.views;
                    totalCalls += stats.calls;
                    if (stats.views > 0) activePets++;
                });

                document.getElementById('totalUsers').textContent = usersSnapshot.size;
                document.getElementById('totalPets').textContent = petsSnapshot.size;
                document.getElementById('activePets').textContent = activePets;
                document.getElementById('totalViews').textContent = totalViews;
                document.getElementById('totalCalls').textContent = totalCalls;
                
            } catch (error) {
                console.error("Admin istatistikleri Ã§ekilirken hata:", error);
                showNotification("Admin verileri Ã§ekilemedi: GÃ¼venlik kurallarÄ±nÄ± kontrol edin.", 'error');
            }
        }
        
        // DÃœZELTÄ°LDÄ°: Navigation Update (Ã‡Ä±kÄ±ÅŸ Yap butonu iÃ§in)
        function updateNavigation() {
            if (currentUser) {
                document.getElementById('loginBtn').textContent = 'Ã‡Ä±kÄ±ÅŸ Yap';
                document.getElementById('registerBtn').style.display = 'none';
            } else {
                document.getElementById('loginBtn').textContent = 'GiriÅŸ Yap';
                document.getElementById('registerBtn').style.display = 'block';
            }
        }

        // DÃœZELTÄ°LDÄ°: Pet Listeleme (Firebase verisini kullanÄ±r)
        function renderPetsList() {
            const petsList = document.getElementById('petsList');
            petsList.innerHTML = '';
            
            const userPets = pets; 
            
            if (userPets.length === 0) {
                 petsList.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <div class="text-6xl">ğŸ¾</div>
                        <h3 class="text-xl font-semibold text-gray-600 mb-2">HenÃ¼z hayvan profili oluÅŸturmadÄ±nÄ±z</h3>
                        <p class="text-gray-500 mb-6">Ä°lk hayvan profilinizi oluÅŸturmak iÃ§in butona tÄ±klayÄ±n</p>
                        <button onclick="showModal('addPetModal')" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-medium">
                            ğŸ¾ Ä°lk Profilimi OluÅŸtur
                        </button>
                    </div>
                `;
                return;
            }
            
            userPets.forEach(pet => {
                const stats = pet.stats || { views: 0, calls: 0 };
                const createdAtDate = pet.createdAt && pet.createdAt.toDate ? pet.createdAt.toDate() : new Date(); // Timestamp objesini date'e Ã§evir
                
                const petCard = document.createElement('div');
                petCard.className = 'pet-card bg-white rounded-xl shadow-lg p-6';
                
                petCard.innerHTML = `
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-xl font-bold text-gray-900">${pet.name}</h3>
                        <div class="flex space-x-2">
                            <button onclick="editPet('${pet.id}')" class="text-blue-600 hover:text-blue-800 p-2 rounded-lg hover:bg-blue-50">âœï¸</button>
                            <button onclick="deletePetConfirm('${pet.id}')" class="text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50">ğŸ—‘ï¸</button>
                        </div>
                    </div>
                    ${pet.photo ? `<div class="mb-4"><img src="${pet.photo}" alt="${pet.name}" class="w-full h-48 object-cover rounded-lg" onerror="this.style.display='none'"></div>` : `<div class="mb-4 h-48 bg-gradient-to-br from-purple-100 to-pink-100 rounded-lg flex items-center justify-center"><div class="text-6xl">${getAnimalEmoji(pet.type)}</div></div>`}
                    <div class="space-y-2 mb-4">
                        <div class="flex justify-between"><span class="text-gray-600">TÃ¼r:</span><span class="font-medium">${pet.type}</span></div>
                        ${pet.breed ? `<div class="flex justify-between"><span class="text-gray-600">Cins:</span><span class="font-medium">${pet.breed}</span></div>` : ''}
                        ${pet.birthDate ? `<div class="flex justify-between"><span class="text-gray-600">YaÅŸ:</span><span class="font-medium">${calculateAge(pet.birthDate)}</span></div>` : ''}
                    </div>
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div class="stats-card text-white p-3 rounded-lg text-center"><div class="text-2xl font-bold">${stats.views}</div><div class="text-sm">GÃ¶rÃ¼ntÃ¼lenme</div></div>
                        <div class="location-card text-white p-3 rounded-lg text-center"><div class="text-2xl font-bold">${stats.calls}</div><div class="text-sm">Arama</div></div>
                    </div>
                    <div class="space-y-2">
                        <button onclick="viewPetProfile('${pet.id}')" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg font-medium">ğŸ‘ï¸ Profili GÃ¶rÃ¼ntÃ¼le</button>
                        <button onclick="copyPetLink('${pet.id}')" class="w-full bg-gray-600 hover:bg-gray-700 text-white py-2 rounded-lg font-medium">ğŸ”— Linki Kopyala</button>
                        <div class="text-xs text-gray-500 text-center mt-2">OluÅŸturulma: ${createdAtDate.toLocaleDateString('tr-TR')}</div>
                    </div>
                `;
                
                petsList.appendChild(petCard);
            });
        }
        
        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('nfcPriceDisplay').textContent = `â‚º${adminSettings.nfcPrice || 25}`;
            
            // Event listener'lar (Sadece Form submit'ler Firebase fonksiyonlarÄ±na baÄŸlÄ±)
            document.getElementById('closeLoginModal').addEventListener('click', () => hideModal('loginModal'));
            document.getElementById('closeRegisterModal').addEventListener('click', () => hideModal('registerModal'));
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('registerForm').addEventListener('submit', handleRegister);
            document.getElementById('addPetForm').addEventListener('submit', handleAddPet);
            document.getElementById('editPetForm').addEventListener('submit', handleEditPet);
            document.getElementById('addCustomField').addEventListener('click', addCustomField);
            document.getElementById('addEditCustomField').addEventListener('click', addEditCustomField);
            
            // URL parametre kontrolÃ¼ (Authentication listener'dan Ã¶nce Ã§alÄ±ÅŸabilir)
            const urlParams = new URLSearchParams(window.location.search);
            const petId = urlParams.get('pet');
            const isAdmin = urlParams.get('admin');
            
            // Bu kÄ±sÄ±m artÄ±k Firebase Listener tarafÄ±ndan kontrol ediliyor, bu kÄ±sÄ±m sadece Admin/Pet ID varsa Ã§alÄ±ÅŸÄ±r.
            if (isAdmin === 'true') {
                showAdminLogin();
            } else if (petId) {
                // showPetProfile(petId) zaten Listener iÃ§inde de Ã§aÄŸrÄ±lÄ±yor, burada tekrar Ã§aÄŸÄ±rmak redundant olabilir.
            }
        });
        
        // Make all functions globally available for onclick handlers
        window.handleLoginClick = handleLoginClick;
        window.showModal = showModal;
        window.hideModal = hideModal;
        window.switchTab = switchTab;
        window.switchEditTab = switchEditTab;
        window.addPhoto = addPhoto;
        window.addVideo = addVideo;
        window.addEditPhoto = addEditPhoto;
        window.addEditVideo = addEditVideo;
        window.removePhoto = removePhoto;
        window.removeVideo = removeVideo;
        window.removeEditPhoto = removeEditPhoto;
        window.removeEditVideo = removeEditVideo;
        window.addCustomField = addCustomField;
        window.addEditCustomField = addEditCustomField;
        window.editPet = editPet;
        window.deletePetConfirm = deletePetConfirm;
        window.deletePet = deletePet;
        window.viewPetProfile = viewPetProfile;
        window.copyPetLink = copyPetLink;
        window.callOwner = callOwner;
        window.shareLocation = shareLocation;
        window.showWelcomeSection = showWelcomeSection;
        window.logout = logout;
        window.updateAdminStats = updateAdminStats;
    </script>
</body>
</html>
